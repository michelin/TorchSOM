

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>torchsom.core module &mdash; TorchSOM 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="torchsom" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #B22222" >

          
          
          <a href="index.html" class="icon icon-home">
            TorchSOM
              <img src="_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">torchsom</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">torchsom.core module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.core.BaseSOM"><code class="docutils literal notranslate"><span class="pre">BaseSOM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.BaseSOM.build_distance_map"><code class="docutils literal notranslate"><span class="pre">BaseSOM.build_distance_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.BaseSOM.build_hit_map"><code class="docutils literal notranslate"><span class="pre">BaseSOM.build_hit_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.BaseSOM.fit"><code class="docutils literal notranslate"><span class="pre">BaseSOM.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.BaseSOM.identify_bmus"><code class="docutils literal notranslate"><span class="pre">BaseSOM.identify_bmus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.BaseSOM.initialize_weights"><code class="docutils literal notranslate"><span class="pre">BaseSOM.initialize_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.BaseSOM.quantization_error"><code class="docutils literal notranslate"><span class="pre">BaseSOM.quantization_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.BaseSOM.topographic_error"><code class="docutils literal notranslate"><span class="pre">BaseSOM.topographic_error()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.core.SOM"><code class="docutils literal notranslate"><span class="pre">SOM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.build_bmus_data_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_bmus_data_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.build_classification_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_classification_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.build_distance_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_distance_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.build_hit_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_hit_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.build_metric_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_metric_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.build_rank_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_rank_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.build_score_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_score_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.collect_samples"><code class="docutils literal notranslate"><span class="pre">SOM.collect_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.fit"><code class="docutils literal notranslate"><span class="pre">SOM.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.identify_bmus"><code class="docutils literal notranslate"><span class="pre">SOM.identify_bmus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.initialize_weights"><code class="docutils literal notranslate"><span class="pre">SOM.initialize_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.quantization_error"><code class="docutils literal notranslate"><span class="pre">SOM.quantization_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.core.SOM.topographic_error"><code class="docutils literal notranslate"><span class="pre">SOM.topographic_error()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#torchsom-decay-module">torchsom.decay module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#torchsom-distances-module">torchsom.distances module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#torchsom-neighborhood-module">torchsom.neighborhood module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#torchsom-plotting-module">torchsom.plotting module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-torchsom.utils">torchsom.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.adjust_meshgrid_topology"><code class="docutils literal notranslate"><span class="pre">adjust_meshgrid_topology()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.axial_distance"><code class="docutils literal notranslate"><span class="pre">axial_distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.calculate_quantization_error"><code class="docutils literal notranslate"><span class="pre">calculate_quantization_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.calculate_topographic_error"><code class="docutils literal notranslate"><span class="pre">calculate_topographic_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.convert_to_axial_coords"><code class="docutils literal notranslate"><span class="pre">convert_to_axial_coords()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.create_mesh_grid"><code class="docutils literal notranslate"><span class="pre">create_mesh_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.get_all_neighbors_up_to_order"><code class="docutils literal notranslate"><span class="pre">get_all_neighbors_up_to_order()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.get_hexagonal_offsets"><code class="docutils literal notranslate"><span class="pre">get_hexagonal_offsets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.get_rectangular_offsets"><code class="docutils literal notranslate"><span class="pre">get_rectangular_offsets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.initialize_weights"><code class="docutils literal notranslate"><span class="pre">initialize_weights()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.offset_to_axial_coords"><code class="docutils literal notranslate"><span class="pre">offset_to_axial_coords()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.pca_init"><code class="docutils literal notranslate"><span class="pre">pca_init()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.utils.random_init"><code class="docutils literal notranslate"><span class="pre">random_init()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-torchsom">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.BaseSOM"><code class="docutils literal notranslate"><span class="pre">BaseSOM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.BaseSOM.build_distance_map"><code class="docutils literal notranslate"><span class="pre">BaseSOM.build_distance_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.BaseSOM.build_hit_map"><code class="docutils literal notranslate"><span class="pre">BaseSOM.build_hit_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.BaseSOM.fit"><code class="docutils literal notranslate"><span class="pre">BaseSOM.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.BaseSOM.identify_bmus"><code class="docutils literal notranslate"><span class="pre">BaseSOM.identify_bmus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.BaseSOM.initialize_weights"><code class="docutils literal notranslate"><span class="pre">BaseSOM.initialize_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.BaseSOM.quantization_error"><code class="docutils literal notranslate"><span class="pre">BaseSOM.quantization_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.BaseSOM.topographic_error"><code class="docutils literal notranslate"><span class="pre">BaseSOM.topographic_error()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.SOM"><code class="docutils literal notranslate"><span class="pre">SOM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.build_bmus_data_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_bmus_data_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.build_classification_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_classification_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.build_distance_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_distance_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.build_hit_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_hit_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.build_metric_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_metric_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.build_rank_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_rank_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.build_score_map"><code class="docutils literal notranslate"><span class="pre">SOM.build_score_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.collect_samples"><code class="docutils literal notranslate"><span class="pre">SOM.collect_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.fit"><code class="docutils literal notranslate"><span class="pre">SOM.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.identify_bmus"><code class="docutils literal notranslate"><span class="pre">SOM.identify_bmus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.initialize_weights"><code class="docutils literal notranslate"><span class="pre">SOM.initialize_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.quantization_error"><code class="docutils literal notranslate"><span class="pre">SOM.quantization_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOM.topographic_error"><code class="docutils literal notranslate"><span class="pre">SOM.topographic_error()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.SOMVisualizer"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_all"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_classification_map"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_classification_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_component_planes"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_component_planes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_distance_map"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_distance_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_grid"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_hit_map"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_hit_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_metric_map"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_metric_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_rank_map"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_rank_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_score_map"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_score_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.SOMVisualizer.plot_training_errors"><code class="docutils literal notranslate"><span class="pre">SOMVisualizer.plot_training_errors()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#torchsom.VisualizationConfig"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.cmap"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.cmap</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.colorbar_pad"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.colorbar_pad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.dpi"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.dpi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.figsize"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.figsize</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.fontsize"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.fontsize</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.fontweight"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.fontweight</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.grid_alpha"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.grid_alpha</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.hexgrid_size"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.hexgrid_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchsom.VisualizationConfig.save_format"><code class="docutils literal notranslate"><span class="pre">VisualizationConfig.save_format</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #B22222" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TorchSOM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">torchsom</a></li>
      <li class="breadcrumb-item active">torchsom.core module</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/LouisTier/TorchSOM/blob/dev_org/docs/source/torchsom.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="modules.html" class="btn btn-neutral float-left" title="torchsom" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-torchsom.core">
<span id="torchsom-core-module"></span><h1>torchsom.core module<a class="headerlink" href="#module-torchsom.core" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchsom.core.</span></span><span class="sig-name descname"><span class="pre">BaseSOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for all SOM variants.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM.build_distance_map">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_distance_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.build_distance_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM.build_distance_map" title="Link to this definition"></a></dt>
<dd><p>Build a distance map (U-matrix) showing neuron similarities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scaling</strong> (<em>str</em><em>, </em><em>optional</em>) – Scaling method for distances. Defaults to “sum”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance map [row_neurons, col_neurons]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM.build_hit_map">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_hit_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.build_hit_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM.build_hit_map" title="Link to this definition"></a></dt>
<dd><p>Build a hit map showing neuron activation frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hit map [row_neurons, col_neurons]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM.fit" title="Link to this definition"></a></dt>
<dd><p>Train the SOM on the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantization and topographic errors [epoch]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[float], List[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM.identify_bmus">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identify_bmus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.identify_bmus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM.identify_bmus" title="Link to this definition"></a></dt>
<dd><p>Find best matching units for input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For single sample: Tensor of shape [2] with [row, col].</dt><dd><p>For batch: Tensor of shape [batch_size, 2] with [row, col] pairs</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM.initialize_weights">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.initialize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM.initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Initialize the SOM weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Weight initialization method. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM.quantization_error">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">quantization_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.quantization_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM.quantization_error" title="Link to this definition"></a></dt>
<dd><p>Calculate quantization error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average quantization error value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.BaseSOM.topographic_error">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">topographic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.topographic_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.BaseSOM.topographic_error" title="Link to this definition"></a></dt>
<dd><p>Calculate topographic error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Topographic error ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchsom.core.SOM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchsom.core.</span></span><span class="sig-name descname"><span class="pre">SOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_decay_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_decay_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialization_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchsom.BaseSOM" title="torchsom.core.base_som.BaseSOM"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSOM</span></code></a></p>
<p>PyTorch implementation of Self Organizing Maps using batch learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BaseSOM</strong> – Abstract base class for SOM variants</p></li>
<li><p><strong>x</strong> (<em>int</em>)</p></li>
<li><p><strong>y</strong> (<em>int</em>)</p></li>
<li><p><strong>num_features</strong> (<em>int</em>)</p></li>
<li><p><strong>epochs</strong> (<em>int</em>)</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>)</p></li>
<li><p><strong>sigma</strong> (<em>float</em>)</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>)</p></li>
<li><p><strong>neighborhood_order</strong> (<em>int</em>)</p></li>
<li><p><strong>topology</strong> (<em>str</em>)</p></li>
<li><p><strong>lr_decay_function</strong> (<em>str</em>)</p></li>
<li><p><strong>sigma_decay_function</strong> (<em>str</em>)</p></li>
<li><p><strong>neighborhood_function</strong> (<em>str</em>)</p></li>
<li><p><strong>distance_function</strong> (<em>str</em>)</p></li>
<li><p><strong>initialization_mode</strong> (<em>str</em>)</p></li>
<li><p><strong>device</strong> (<em>str</em>)</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.build_bmus_data_map">
<span class="sig-name descname"><span class="pre">build_bmus_data_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_bmus_data_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.build_bmus_data_map" title="Link to this definition"></a></dt>
<dd><p>Create a mapping of winning neurons to their corresponding data points.
It processes the data in batches to save memory.
The hit map is built on CPU, but the calculations are done on GPU if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [num_samples, num_features] or [num_features]</p></li>
<li><p><strong>return_indices</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return indices instead of data points. Defaults to False.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of batches to process. Defaults to 1024.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping bmus to data samples or indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[Tuple[int, int], Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.build_classification_map">
<span class="sig-name descname"><span class="pre">build_classification_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_classification_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.build_classification_map" title="Link to this definition"></a></dt>
<dd><p>Build a classification map where each neuron is assigned the most frequent label.
In case of a tie, consider labels from neighboring neurons.
If there are no neighboring neurons or a second tie, then randomly select one of the top label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]. They are assumed to be encoded with value &gt; 1 for decent visualization.</p></li>
<li><p><strong>neighborhood_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Neighborhood order to consider for tie-breaking. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Classification map with the most frequent label for each neuron</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.build_distance_map">
<span class="sig-name descname"><span class="pre">build_distance_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_distance_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.build_distance_map" title="Link to this definition"></a></dt>
<dd><p>Computes the distance map of each neuron with its neighbors.</p>
<p>The distance map represents the normalized sum or mean of distances
between a neuron’s weight vector and its neighboring neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scaling</strong> (<em>str</em><em>, </em><em>optional</em>) – Defaults to “sum”.
If ‘mean’, each cell is normalized by the average neighbor distance.
If ‘sum’, normalization is done by the sum of distances.</p></li>
<li><p><strong>distance_metric</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the method to calculate the distance. Defaults to None.</p></li>
<li><p><strong>neighborhood_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Indicate the neighbors to consider for the distance calculation. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If an invalid scaling option is provided.</p></li>
<li><p><strong>ValueError</strong> – If an invalid distance metric is provided.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalized distance map [row_neurons, col_neurons]</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.build_hit_map">
<span class="sig-name descname"><span class="pre">build_hit_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_hit_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.build_hit_map" title="Link to this definition"></a></dt>
<dd><p>Returns a matrix where element i,j is the number of times that neuron i,j has been the winner.
It processes the data in batches to save memory.
The hit map is built on CPU, but the calculations are done on GPU if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features]</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of batches to process. Defaults to 1024.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix indicating the number of times each neuron has been identified as bmu.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.build_metric_map">
<span class="sig-name descname"><span class="pre">build_metric_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_parameter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_metric_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.build_metric_map" title="Link to this definition"></a></dt>
<dd><p>Calculate neurons’ metrics based on target values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]</p></li>
<li><p><strong>reduction_parameter</strong> (<em>str</em>) – Decide the calculation to apply to each neuron, ‘mean’ or ‘std’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric map based on the reduction parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.build_rank_map">
<span class="sig-name descname"><span class="pre">build_rank_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_rank_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.build_rank_map" title="Link to this definition"></a></dt>
<dd><p>Build a map of neuron ranks based on their target value standard deviations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rank map where each neuron’s value is its rank (1 = lowest std = best)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.build_score_map">
<span class="sig-name descname"><span class="pre">build_score_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_score_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.build_score_map" title="Link to this definition"></a></dt>
<dd><p>Calculate neurons’ score based on target values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score map based on a chosen score function: std_neuron / sqrt(n_neuron) * log(N_data/n_neuron).
The score combines the standard error with a term penalizing uneven sample distribution across neurons. Lower scores indicate better neuron representativeness.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.collect_samples">
<span class="sig-name descname"><span class="pre">collect_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_buffer_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmus_idx_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.collect_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.collect_samples" title="Link to this definition"></a></dt>
<dd><p>Collect historical samples similar to the query sample using SOM projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_sample</strong> (<em>torch.Tensor</em>) – The query data point [num_features]</p></li>
<li><p><strong>historical_samples</strong> (<em>torch.Tensor</em>) – Historical input data [num_samples, num_features]</p></li>
<li><p><strong>historical_outputs</strong> (<em>torch.Tensor</em>) – Historical output values [num_samples]</p></li>
<li><p><strong>min_buffer_threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of samples to collect. Defaults to 50.</p></li>
<li><p><strong>bmus_idx_map</strong> (<em>Dict</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(historical_data_buffer, historical_output_buffer)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.fit" title="Link to this definition"></a></dt>
<dd><p>Train the SOM using batches and track errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantization and topographic errors [epoch]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[float], List[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.identify_bmus">
<span class="sig-name descname"><span class="pre">identify_bmus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.identify_bmus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.identify_bmus" title="Link to this definition"></a></dt>
<dd><p>Find BMUs for input data.  Handles both single samples and batches.
It requires a data on the GPU if available for calculations with SOM’s weights on GPU’s too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input tensor of shape [num_features] or [batch_size, num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For single sample: Tensor of shape [2] with [row, col].</dt><dd><p>For batch: Tensor of shape [batch_size, 2] with [row, col] pairs</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.initialize_weights">
<span class="sig-name descname"><span class="pre">initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.initialize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Data should be normalized before initialization. Initialize weights using</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Random samples from input data.</p></li>
<li><p>PCA components to make the training process converge faster.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features]</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – selection of the method to init the weights. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Ensure neurons’ weights and input data have the same number of features</p></li>
<li><p><strong>RuntimeError</strong> – If random initialization takes too long</p></li>
<li><p><strong>ValueError</strong> – Requires at least 2 features for PCA</p></li>
<li><p><strong>ValueError</strong> – Requires more than one sample to perform PCA</p></li>
<li><p><strong>ValueError</strong> – Ensure an appropriate method for initialization</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.quantization_error">
<span class="sig-name descname"><span class="pre">quantization_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.quantization_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.quantization_error" title="Link to this definition"></a></dt>
<dd><p>Calculate quantization error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average quantization error value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.core.SOM.topographic_error">
<span class="sig-name descname"><span class="pre">topographic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.topographic_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.core.SOM.topographic_error" title="Link to this definition"></a></dt>
<dd><p>Calculate topographic error with batch support</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Topographic error ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="torchsom-decay-module">
<h1>torchsom.decay module<a class="headerlink" href="#torchsom-decay-module" title="Link to this heading"></a></h1>
</section>
<section id="torchsom-distances-module">
<h1>torchsom.distances module<a class="headerlink" href="#torchsom-distances-module" title="Link to this heading"></a></h1>
</section>
<section id="torchsom-neighborhood-module">
<h1>torchsom.neighborhood module<a class="headerlink" href="#torchsom-neighborhood-module" title="Link to this heading"></a></h1>
</section>
<section id="torchsom-plotting-module">
<h1>torchsom.plotting module<a class="headerlink" href="#torchsom-plotting-module" title="Link to this heading"></a></h1>
</section>
<section id="module-torchsom.utils">
<span id="torchsom-utils-module"></span><h1>torchsom.utils module<a class="headerlink" href="#module-torchsom.utils" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.adjust_meshgrid_topology">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">adjust_meshgrid_topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/grid.html#adjust_meshgrid_topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.adjust_meshgrid_topology" title="Link to this definition"></a></dt>
<dd><p>Adjust coordinates based on topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>torch.Tensor</em>) – Mesh grid of x coordinates</p></li>
<li><p><strong>yy</strong> (<em>torch.Tensor</em>) – Mesh grid of y coordinates</p></li>
<li><p><strong>topology</strong> (<em>str</em>) – SOM configuration, usually rectangular or hexagonal</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Adjusted x and y mesh grids for a hexagonal topology.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.axial_distance">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">axial_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/grid.html#axial_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.axial_distance" title="Link to this definition"></a></dt>
<dd><p>Calculate the distance between two hexes in axial coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q1</strong> (<em>float</em>) – column of first hex</p></li>
<li><p><strong>r1</strong> (<em>float</em>) – row of first hex</p></li>
<li><p><strong>q2</strong> (<em>float</em>) – column of second hex</p></li>
<li><p><strong>r2</strong> (<em>float</em>) – row of second hex</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance in hex steps</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.calculate_quantization_error">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_quantization_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/metrics.html#calculate_quantization_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.calculate_quantization_error" title="Link to this definition"></a></dt>
<dd><p>Calculate quantization error for a SOM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – SOM weights [row_neurons, col_neurons, num_features]</p></li>
<li><p><strong>distance_fn</strong> (<em>callable</em>) – Function to compute distances between data and weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average quantization error value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.calculate_topographic_error">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_topographic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/metrics.html#calculate_topographic_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.calculate_topographic_error" title="Link to this definition"></a></dt>
<dd><p>Calculate topographic error for a SOM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p></li>
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – SOM weights [row_neurons, col_neurons, num_features]</p></li>
<li><p><strong>distance_fn</strong> (<em>callable</em>) – Function to compute distances between data and weights</p></li>
<li><p><strong>topology</strong> (<em>str</em><em>, </em><em>optional</em>) – Grid configuration. Defaults to “rectangular”.</p></li>
<li><p><strong>xx</strong> (<em>#</em>) – Meshgrid of x coordinates. Required for hexagonal topology. Defaults to None.</p></li>
<li><p><strong>yy</strong> (<em>#</em>) – Meshgrid of y coordinates. Required for hexagonal topology. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Topographic error ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.convert_to_axial_coords">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">convert_to_axial_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/grid.html#convert_to_axial_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.convert_to_axial_coords" title="Link to this definition"></a></dt>
<dd><p>Convert grid coordinates to axial coordinates for hexagonal grid.</p>
<p>Uses even-r layout where even rows are shifted left by 0.5.
This matches the layout used in adjust_meshgrid_topology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> (<em>int</em>) – Grid row coordinate</p></li>
<li><p><strong>col</strong> (<em>int</em>) – Grid column coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axial coordinates (q, r)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.create_mesh_grid">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">create_mesh_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/grid.html#create_mesh_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.create_mesh_grid" title="Link to this definition"></a></dt>
<dd><p>Create a mesh grid for neighborhood calculations.</p>
<p>The function returns two 2D tensors representing the x-coordinates and y-coordinates
of a grid of shape (x, y). This is useful for computing distance-based neighborhood functions
in Self-Organizing Maps (SOM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>int</em>) – Number of rows (height of the grid).</p></li>
<li><p><strong>y</strong> (<em>int</em>) – Number of columns (width of the grid).</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device on which tensors should be allocated (‘cpu’ or ‘cuda’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two tensors (xx, yy) of shape (x, y), representing the x and y coordinates of the mesh grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.get_all_neighbors_up_to_order">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">get_all_neighbors_up_to_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/topology.html#get_all_neighbors_up_to_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.get_all_neighbors_up_to_order" title="Link to this definition"></a></dt>
<dd><p>Get all neighbors from order 1 up to max_order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topology</strong> (<em>str</em>) – “rectangular” or “hexagonal”</p></li>
<li><p><strong>max_order</strong> (<em>int</em>) – Maximum neighborhood order to include</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All neighbor offsets from order 1 to max_order combined</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[int, int]] | <em>Dict</em>[str, <em>List</em>[<em>Tuple</em>[int, int]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.get_hexagonal_offsets">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">get_hexagonal_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/topology.html#get_hexagonal_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.get_hexagonal_offsets" title="Link to this definition"></a></dt>
<dd><p>Get neighbor offset coordinates for hexagonal topology at any order.
Order n has 6*n elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>neighborhood_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of neighborhood ring. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Offsets for even and odd rows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, List[Tuple[int, int]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.get_rectangular_offsets">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">get_rectangular_offsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/topology.html#get_rectangular_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.get_rectangular_offsets" title="Link to this definition"></a></dt>
<dd><p>Get neighbor offset coordinates for rectangular topology at any order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>neighborhood_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of neighborhood ring. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Coordinate offsets for rectangular grid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[int, int]]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Order 1: 8 neighbors
Order 2: 16 neighbors
Order 3: 24 neighbors
Order 3+: All positions at Chebyshev distance (order-1)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.initialize_weights">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/initialization.html#initialize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Main function to initialize weights based on specified method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – Weight tensor to initialize [row_neurons, col_neurons, num_features]</p></li>
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Initialization method, “random” or “pca”. Defaults to “random”.</p></li>
<li><p><strong>topology</strong> (<em>str</em><em>, </em><em>optional</em>) – Grid configuration, “rectangular” or “hexagonal”. Defaults to “rectangular”.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device for tensor computations. Defaults to “cuda” if available, else “cpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initialized weights</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an invalid initialization mode is provided</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.offset_to_axial_coords">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">offset_to_axial_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/grid.html#offset_to_axial_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.offset_to_axial_coords" title="Link to this definition"></a></dt>
<dd><p>Convert offset coordinates to axial coordinates for hexagonal grid.</p>
<p>Alternative implementation that directly matches the mesh grid adjustment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> (<em>int</em>) – Grid row coordinate</p></li>
<li><p><strong>col</strong> (<em>int</em>) – Grid column coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axial coordinates (q, r)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.pca_init">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">pca_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/initialization.html#pca_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.pca_init" title="Link to this definition"></a></dt>
<dd><p>Initialize SOM weights using PCA for faster convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – Weight tensor to initialize [row_neurons, col_neurons, num_features]</p></li>
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>topology</strong> (<em>str</em>) – Grid configuration, “rectangular” or “hexagonal”</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device for tensor computations. Defaults to “cuda” if available, else “cpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initialized weights</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchsom.utils.random_init">
<span class="sig-prename descclassname"><span class="pre">torchsom.utils.</span></span><span class="sig-name descname"><span class="pre">random_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/utils/initialization.html#random_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.utils.random_init" title="Link to this definition"></a></dt>
<dd><p>Initialize SOM weights by sampling random data points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>torch.Tensor</em>) – Weight tensor to initialize [row_neurons, col_neurons, num_features]</p></li>
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor to sample from [batch_size, num_features]</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device for tensor computations. Defaults to “cuda” if available, else “cpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initialized weights</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-torchsom">
<span id="module-contents"></span><h1>Module contents<a class="headerlink" href="#module-torchsom" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="torchsom.BaseSOM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchsom.</span></span><span class="sig-name descname"><span class="pre">BaseSOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for all SOM variants.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchsom.BaseSOM.build_distance_map">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_distance_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.build_distance_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM.build_distance_map" title="Link to this definition"></a></dt>
<dd><p>Build a distance map (U-matrix) showing neuron similarities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scaling</strong> (<em>str</em><em>, </em><em>optional</em>) – Scaling method for distances. Defaults to “sum”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance map [row_neurons, col_neurons]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.BaseSOM.build_hit_map">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">build_hit_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.build_hit_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM.build_hit_map" title="Link to this definition"></a></dt>
<dd><p>Build a hit map showing neuron activation frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hit map [row_neurons, col_neurons]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.BaseSOM.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM.fit" title="Link to this definition"></a></dt>
<dd><p>Train the SOM on the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantization and topographic errors [epoch]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[float], List[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.BaseSOM.identify_bmus">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">identify_bmus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.identify_bmus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM.identify_bmus" title="Link to this definition"></a></dt>
<dd><p>Find best matching units for input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For single sample: Tensor of shape [2] with [row, col].</dt><dd><p>For batch: Tensor of shape [batch_size, 2] with [row, col] pairs</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.BaseSOM.initialize_weights">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.initialize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM.initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Initialize the SOM weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Weight initialization method. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.BaseSOM.quantization_error">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">quantization_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.quantization_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM.quantization_error" title="Link to this definition"></a></dt>
<dd><p>Calculate quantization error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average quantization error value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.BaseSOM.topographic_error">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">topographic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/base_som.html#BaseSOM.topographic_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.BaseSOM.topographic_error" title="Link to this definition"></a></dt>
<dd><p>Calculate topographic error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Topographic error ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchsom.SOM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchsom.</span></span><span class="sig-name descname"><span class="pre">SOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_decay_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_decay_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asymptotic_decay'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initialization_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#torchsom.BaseSOM" title="torchsom.core.base_som.BaseSOM"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSOM</span></code></a></p>
<p>PyTorch implementation of Self Organizing Maps using batch learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BaseSOM</strong> – Abstract base class for SOM variants</p></li>
<li><p><strong>x</strong> (<em>int</em>)</p></li>
<li><p><strong>y</strong> (<em>int</em>)</p></li>
<li><p><strong>num_features</strong> (<em>int</em>)</p></li>
<li><p><strong>epochs</strong> (<em>int</em>)</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>)</p></li>
<li><p><strong>sigma</strong> (<em>float</em>)</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>)</p></li>
<li><p><strong>neighborhood_order</strong> (<em>int</em>)</p></li>
<li><p><strong>topology</strong> (<em>str</em>)</p></li>
<li><p><strong>lr_decay_function</strong> (<em>str</em>)</p></li>
<li><p><strong>sigma_decay_function</strong> (<em>str</em>)</p></li>
<li><p><strong>neighborhood_function</strong> (<em>str</em>)</p></li>
<li><p><strong>distance_function</strong> (<em>str</em>)</p></li>
<li><p><strong>initialization_mode</strong> (<em>str</em>)</p></li>
<li><p><strong>device</strong> (<em>str</em>)</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.build_bmus_data_map">
<span class="sig-name descname"><span class="pre">build_bmus_data_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_bmus_data_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.build_bmus_data_map" title="Link to this definition"></a></dt>
<dd><p>Create a mapping of winning neurons to their corresponding data points.
It processes the data in batches to save memory.
The hit map is built on CPU, but the calculations are done on GPU if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [num_samples, num_features] or [num_features]</p></li>
<li><p><strong>return_indices</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, return indices instead of data points. Defaults to False.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of batches to process. Defaults to 1024.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping bmus to data samples or indices</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[Tuple[int, int], Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.build_classification_map">
<span class="sig-name descname"><span class="pre">build_classification_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_classification_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.build_classification_map" title="Link to this definition"></a></dt>
<dd><p>Build a classification map where each neuron is assigned the most frequent label.
In case of a tie, consider labels from neighboring neurons.
If there are no neighboring neurons or a second tie, then randomly select one of the top label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]. They are assumed to be encoded with value &gt; 1 for decent visualization.</p></li>
<li><p><strong>neighborhood_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Neighborhood order to consider for tie-breaking. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Classification map with the most frequent label for each neuron</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.build_distance_map">
<span class="sig-name descname"><span class="pre">build_distance_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighborhood_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_distance_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.build_distance_map" title="Link to this definition"></a></dt>
<dd><p>Computes the distance map of each neuron with its neighbors.</p>
<p>The distance map represents the normalized sum or mean of distances
between a neuron’s weight vector and its neighboring neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scaling</strong> (<em>str</em><em>, </em><em>optional</em>) – Defaults to “sum”.
If ‘mean’, each cell is normalized by the average neighbor distance.
If ‘sum’, normalization is done by the sum of distances.</p></li>
<li><p><strong>distance_metric</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the method to calculate the distance. Defaults to None.</p></li>
<li><p><strong>neighborhood_order</strong> (<em>int</em><em>, </em><em>optional</em>) – Indicate the neighbors to consider for the distance calculation. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If an invalid scaling option is provided.</p></li>
<li><p><strong>ValueError</strong> – If an invalid distance metric is provided.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalized distance map [row_neurons, col_neurons]</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.build_hit_map">
<span class="sig-name descname"><span class="pre">build_hit_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_hit_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.build_hit_map" title="Link to this definition"></a></dt>
<dd><p>Returns a matrix where element i,j is the number of times that neuron i,j has been the winner.
It processes the data in batches to save memory.
The hit map is built on CPU, but the calculations are done on GPU if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features]</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of batches to process. Defaults to 1024.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix indicating the number of times each neuron has been identified as bmu.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.build_metric_map">
<span class="sig-name descname"><span class="pre">build_metric_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_parameter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_metric_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.build_metric_map" title="Link to this definition"></a></dt>
<dd><p>Calculate neurons’ metrics based on target values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]</p></li>
<li><p><strong>reduction_parameter</strong> (<em>str</em>) – Decide the calculation to apply to each neuron, ‘mean’ or ‘std’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Metric map based on the reduction parameter.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.build_rank_map">
<span class="sig-name descname"><span class="pre">build_rank_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_rank_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.build_rank_map" title="Link to this definition"></a></dt>
<dd><p>Build a map of neuron ranks based on their target value standard deviations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rank map where each neuron’s value is its rank (1 = lowest std = best)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.build_score_map">
<span class="sig-name descname"><span class="pre">build_score_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.build_score_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.build_score_map" title="Link to this definition"></a></dt>
<dd><p>Calculate neurons’ score based on target values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, num_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score map based on a chosen score function: std_neuron / sqrt(n_neuron) * log(N_data/n_neuron).
The score combines the standard error with a term penalizing uneven sample distribution across neurons. Lower scores indicate better neuron representativeness.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.collect_samples">
<span class="sig-name descname"><span class="pre">collect_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">historical_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_buffer_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmus_idx_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.collect_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.collect_samples" title="Link to this definition"></a></dt>
<dd><p>Collect historical samples similar to the query sample using SOM projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_sample</strong> (<em>torch.Tensor</em>) – The query data point [num_features]</p></li>
<li><p><strong>historical_samples</strong> (<em>torch.Tensor</em>) – Historical input data [num_samples, num_features]</p></li>
<li><p><strong>historical_outputs</strong> (<em>torch.Tensor</em>) – Historical output values [num_samples]</p></li>
<li><p><strong>min_buffer_threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of samples to collect. Defaults to 50.</p></li>
<li><p><strong>bmus_idx_map</strong> (<em>Dict</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(historical_data_buffer, historical_output_buffer)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.fit" title="Link to this definition"></a></dt>
<dd><p>Train the SOM using batches and track errors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantization and topographic errors [epoch]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[float], List[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.identify_bmus">
<span class="sig-name descname"><span class="pre">identify_bmus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.identify_bmus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.identify_bmus" title="Link to this definition"></a></dt>
<dd><p>Find BMUs for input data.  Handles both single samples and batches.
It requires a data on the GPU if available for calculations with SOM’s weights on GPU’s too.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – Input tensor of shape [num_features] or [batch_size, num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>For single sample: Tensor of shape [2] with [row, col].</dt><dd><p>For batch: Tensor of shape [batch_size, 2] with [row, col] pairs</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.initialize_weights">
<span class="sig-name descname"><span class="pre">initialize_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.initialize_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.initialize_weights" title="Link to this definition"></a></dt>
<dd><p>Data should be normalized before initialization. Initialize weights using</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Random samples from input data.</p></li>
<li><p>PCA components to make the training process converge faster.</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features]</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – selection of the method to init the weights. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Ensure neurons’ weights and input data have the same number of features</p></li>
<li><p><strong>RuntimeError</strong> – If random initialization takes too long</p></li>
<li><p><strong>ValueError</strong> – Requires at least 2 features for PCA</p></li>
<li><p><strong>ValueError</strong> – Requires more than one sample to perform PCA</p></li>
<li><p><strong>ValueError</strong> – Ensure an appropriate method for initialization</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.quantization_error">
<span class="sig-name descname"><span class="pre">quantization_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.quantization_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.quantization_error" title="Link to this definition"></a></dt>
<dd><p>Calculate quantization error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average quantization error value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOM.topographic_error">
<span class="sig-name descname"><span class="pre">topographic_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/core/som.html#SOM.topographic_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOM.topographic_error" title="Link to this definition"></a></dt>
<dd><p>Calculate topographic error with batch support</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>torch.Tensor</em>) – input data tensor [batch_size, num_features] or [num_features]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Topographic error ratio</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchsom.</span></span><span class="sig-name descname"><span class="pre">SOMVisualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">som</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for handling Self-Organizing Map visualizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>som</strong> (<a class="reference internal" href="#torchsom.BaseSOM" title="torchsom.core.base_som.BaseSOM"><em>BaseSOM</em></a>)</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#torchsom.VisualizationConfig" title="torchsom.visualization.config.VisualizationConfig"><em>VisualizationConfig</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_all">
<span class="sig-name descname"><span class="pre">plot_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantization_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topographic_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hit_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_planes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_all" title="Link to this definition"></a></dt>
<dd><p>Plot all visualizations: hit map, score map, rank map, metric map, component planes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantization_errors</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of quantization errors [epochs]</p></li>
<li><p><strong>topographic_errors</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of topographic errors [epochs]</p></li>
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, n_features]</p></li>
<li><p><strong>target</strong> (<em>Optional</em><em>[</em><em>torch.Tensor</em><em>]</em><em>, </em><em>optional</em>) – Optional labels tensor for data points [batch_size]. Defaults to None.</p></li>
<li><p><strong>component_names</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Names for each component/feature. If None, uses “Component {i+1}”. Defaults to None.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>training_errors</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to decide if the visualizer plots training learning curves. Defaults to True.</p></li>
<li><p><strong>distance_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to decide if the visualizer plots distance map. Defaults to True.</p></li>
<li><p><strong>hit_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to decide if the visualizer plots hit map. Defaults to True.</p></li>
<li><p><strong>score_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to decide if the visualizer plots score map. Defaults to True.</p></li>
<li><p><strong>rank_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to decide if the visualizer plots rank map. Defaults to True.</p></li>
<li><p><strong>metric_map</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to decide if the visualizer plots metric map. Defaults to True.</p></li>
<li><p><strong>component_planes</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to decide if the visualizer plots component planes. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_classification_map">
<span class="sig-name descname"><span class="pre">plot_classification_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification_map'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_classification_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_classification_map" title="Link to this definition"></a></dt>
<dd><p>Plot classification map showing the most frequent label for each neuron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, n_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Labels tensor for data points [batch_size]. Must be encoded with values &gt; 1 to avoid white cells like unactivated.</p></li>
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save. Defaults to “classification_map”.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_component_planes">
<span class="sig-name descname"><span class="pre">plot_component_planes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_component_planes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_component_planes" title="Link to this definition"></a></dt>
<dd><p>Plot component planes (CPs), so one plane by input feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component_names</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Names for each component/feature. If None, uses “Component {i+1}”. Defaults to None.</p></li>
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save. Defaults to None.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_distance_map">
<span class="sig-name descname"><span class="pre">plot_distance_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'distance_map'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_distance_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_distance_map" title="Link to this definition"></a></dt>
<dd><p>Plot the D-Matrix (distance map) of a trained SOM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save. Defaults to “distance_map”.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_grid">
<span class="sig-name descname"><span class="pre">plot_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.2f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_component_plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_grid" title="Link to this definition"></a></dt>
<dd><p>Universal plotting function for both rectangular and hexagonal grids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> (<em>torch.Tensor</em>) – Data to visualize. [row_neurons, col_neurons]</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Plot title.</p></li>
<li><p><strong>colorbar_label</strong> (<em>str</em>) – Label for the colorbar.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – The name of the file to save.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Path to save the plot. Defaults to None.</p></li>
<li><p><strong>log_scale</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use logarithmic scale for colors. Defaults to False.</p></li>
<li><p><strong>cmap</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Custom colormap to use. Defaults to None.</p></li>
<li><p><strong>show_values</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show values in cells. Defaults to False.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
<li><p><strong>value_format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format string for displayed values. Defaults to “.2f”.</p></li>
<li><p><strong>is_component_plane</strong> (<em>bool</em><em>, </em><em>optional</em>) – Boolean to check if current plot is a component plane. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_hit_map">
<span class="sig-name descname"><span class="pre">plot_hit_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hit_map'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_hit_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_hit_map" title="Link to this definition"></a></dt>
<dd><p>Plot hit map showing the distribution of winning neurons from input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, n_features]</p></li>
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save.. Defaults to “hit_map”.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_metric_map">
<span class="sig-name descname"><span class="pre">plot_metric_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_metric_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_metric_map" title="Link to this definition"></a></dt>
<dd><p>Plot target distribution of the corresponding input samples through SOM’s neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, n_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Optional labels tensor for data points [batch_size]. Defaults to None.</p></li>
<li><p><strong>reduction_parameter</strong> (<em>str</em><em>, </em><em>optional</em>) – Decide the calculation to apply to each neuron, ‘mean’ or ‘std’. Defaults to “mean”.</p></li>
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save. Defaults to None.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_rank_map">
<span class="sig-name descname"><span class="pre">plot_rank_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rank_map'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_rank_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_rank_map" title="Link to this definition"></a></dt>
<dd><p>Plot SOM ranked neurons visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, n_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Optional labels tensor for data points [batch_size]. Defaults to None.</p></li>
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save. Defaults to “rank_map”.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_score_map">
<span class="sig-name descname"><span class="pre">plot_score_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'score_map'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_score_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_score_map" title="Link to this definition"></a></dt>
<dd><p>Plot SOM neuron representativeness visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>torch.Tensor</em>) – Input data tensor [batch_size, n_features]</p></li>
<li><p><strong>target</strong> (<em>torch.Tensor</em>) – Optional labels tensor for data points [batch_size]. Defaults to “score_map”.</p></li>
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save. Defaults to None.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization. Defaults to None.</p></li>
<li><p><strong>gridsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Size of hexagonal grid. If None, calculated from map dimensions. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchsom.SOMVisualizer.plot_training_errors">
<span class="sig-name descname"><span class="pre">plot_training_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantization_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topographic_errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'training_errors'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/base.html#SOMVisualizer.plot_training_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.SOMVisualizer.plot_training_errors" title="Link to this definition"></a></dt>
<dd><p>Plot training errors over epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantization_errors</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of quantization errors [epochs]</p></li>
<li><p><strong>topographic_errors</strong> (<em>List</em><em>[</em><em>float</em><em>]</em>) – List of topographic errors [epochs]</p></li>
<li><p><strong>fig_name</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – The name of the file to save.. Defaults to “training_errors”.</p></li>
<li><p><strong>save_path</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Optional path to save the visualization figure. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchsom.</span></span><span class="sig-name descname"><span class="pre">VisualizationConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize=(12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontweight=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap='viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi=300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_alpha=0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_pad=0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_format='png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hexgrid_size=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchsom/visualization/config.html#VisualizationConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchsom.VisualizationConfig" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration settings for SOM visualizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>)</p></li>
<li><p><strong>fontsize</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>)</p></li>
<li><p><strong>fontweight</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>)</p></li>
<li><p><strong>cmap</strong> (<em>str</em>)</p></li>
<li><p><strong>dpi</strong> (<em>int</em>)</p></li>
<li><p><strong>grid_alpha</strong> (<em>float</em>)</p></li>
<li><p><strong>colorbar_pad</strong> (<em>float</em>)</p></li>
<li><p><strong>save_format</strong> (<em>str</em>)</p></li>
<li><p><strong>hexgrid_size</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.cmap">
<span class="sig-name descname"><span class="pre">cmap</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'viridis'</span></em><a class="headerlink" href="#torchsom.VisualizationConfig.cmap" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.colorbar_pad">
<span class="sig-name descname"><span class="pre">colorbar_pad</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#torchsom.VisualizationConfig.colorbar_pad" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.dpi">
<span class="sig-name descname"><span class="pre">dpi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">300</span></em><a class="headerlink" href="#torchsom.VisualizationConfig.dpi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.figsize">
<span class="sig-name descname"><span class="pre">figsize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(12,</span> <span class="pre">8)</span></em><a class="headerlink" href="#torchsom.VisualizationConfig.figsize" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.fontsize">
<span class="sig-name descname"><span class="pre">fontsize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#torchsom.VisualizationConfig.fontsize" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.fontweight">
<span class="sig-name descname"><span class="pre">fontweight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#torchsom.VisualizationConfig.fontweight" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.grid_alpha">
<span class="sig-name descname"><span class="pre">grid_alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.3</span></em><a class="headerlink" href="#torchsom.VisualizationConfig.grid_alpha" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.hexgrid_size">
<span class="sig-name descname"><span class="pre">hexgrid_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#torchsom.VisualizationConfig.hexgrid_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="torchsom.VisualizationConfig.save_format">
<span class="sig-name descname"><span class="pre">save_format</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'png'</span></em><a class="headerlink" href="#torchsom.VisualizationConfig.save_format" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="torchsom" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Manufacture Française des Pneumatiques Michelin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>